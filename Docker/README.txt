docker network create --driver bridge cvebridge

# note, we can't do -v for mongo under a Mac host, according to mongo docs, because the
# Mac host doesn't support memory mapped files. Should do it
# under linux (and hence perhaps be able to add --rm).

docker run --network cvebridge -p 27017:27017 --name cve-mongo -d mongo:4.2.8

mkdir volumes/redis

docker run --network cvebridge -p 6379:6379 -v volumes/redis:/data --name cve-redis -d redis:6.0.6

git clone git@github.com:ptc-shunt/cve-search.git cve-search
cd cve-search
git checkout docker_support

docker build --tag cvesearch:latest .
docker run --network cvebridge -p 5000:5000 --name cve-search -d cvesearch:latest

Start a shell on the container and do the following to initialize the databases.
Note it will take a LONG time. It is probably a good idea to kill cron while
this is happening, to avoid the nightly update colliding with it.

./sbin/db_mgmt_cpe_dictionary.py -p
./sbin/db_mgmt_json.py -p
./sbin/db_updater.py -c    # Leave it overnight!

Once finished, on the host, open web browser at http://localhost:5000/ and you
should see the CVE database being displayed.


